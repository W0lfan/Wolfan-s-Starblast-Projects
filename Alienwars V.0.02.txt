var maps = [
"                                                                                                    \n"+
"9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999\n"+
"9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999\n"+
"9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999\n"+
"9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999\n"+
"99999999999999999999999999999                 99999999                 99999999999999999999999999999\n"+
"9999999999999999999999999999                   999999                   9999999999999999999999999999\n"+
"999999999999999999999999999                     9999                     999999999999999999999999999\n"+
"99999999999999999999999999                                                99999999999999999999999999\n"+
"9999999999999999999999999    9                                        9    9999999999999999999999999\n"+
"999999999999999999999999    999 999                              999 999    999999999999999999999999\n"+
"99999999999999999999999    99999999             9999             99999999    99999999999999999999999\n"+
"9999999999999999999999      99999999 999        9999        999 99999999      9999999999999999999999\n"+
"999999999999999999999        99999999999      99999999      99999999999        999999999999999999999\n"+
"99999999999999999999        999999999999      99999999      999999999999        99999999999999999999\n"+
"9999999999999999999         999999999999      999  999      999999999999         9999999999999999999\n"+
"9999999999999999999         99999999 999                    999 99999999         9999999999999999999\n"+
"9999999999999999999           99999                              99999           9999999999999999999\n"+
"99999999999999999999           999                                999           99999999999999999999\n"+
"999999999999999999999         99999             9999             99999         999999999999999999999\n"+
"99999999999999   99999        99999             9999             99999        99999   99999999999999\n"+
"9999999999999     99999       99999             9999             99999       99999     9999999999999\n"+
"999999999999       99999                     9999999999                     99999       999999999999\n"+
"99999999999         99999                   99999  99999                   99999         99999999999\n"+
"9999999999           99999               99999999  99999999               99999           9999999999\n"+
"999999999             99999              9999999    9999999              99999             999999999\n"+
"99999999               99999           99999999      99999999           99999               99999999\n"+
"9999999    9            99999          9999              9999          99999            9    9999999\n"+
"999999    999 999        99999         999                999         99999        999 999    999999\n"+
"99999    99999999         99999                                      99999         99999999    99999\n"+
"9999      99999999 999     99999                                    99999     999 99999999      9999\n"+
"9999       99999999999      999999                                999999      99999999999       9999\n"+
"9999      999999999999       9999999                            9999999       999999999999      9999\n"+
"9999      999999999999        999999                            999999        999999999999      9999\n"+
"9999      99999999 999        999999                            999999        999 99999999      9999\n"+
"9999        99999              999                                999              99999        9999\n"+
"9999         999               999 9999                      9999 999               999         9999\n"+
"9999        99999                  99999    999      999    99999                  99999        9999\n"+
"9999        99999                  99999    9999    9999    99999                  99999        9999\n"+
"9999        99999         999      99999    99999  99999    99999      999         99999        9999\n"+
"9999                      999       9999     9999999999     9999       999                      9999\n"+
"9999                    99999                 99999999                 99999                    9999\n"+
"9999                    9999                   999999                   9999                    9999\n"+
"9999                    999          999        9999        999          999                    9999\n"+
"9999                   9999          9999       9999       9999          9999                   9999\n"+
"9999                  99999          99999                99999          99999                  9999\n"+
"99999        999      99999           9999                9999           99999      999        99999\n"+
"999999       999      9999             9999              9999             9999      999       999999\n"+
"9999999    99999   999999               99999          99999               999999   99999    9999999\n"+
"9999999    9999    99999                99999          99999                99999    9999    9999999\n"+
"9999999    9999    99999                99999          99999                99999    9999    9999999\n"+
"9999999    99999   999999               99999          99999               999999   99999    9999999\n"+
"999999       999      9999             9999              9999             9999      999       999999\n"+
"99999        999      99999           9999                9999           99999      999        99999\n"+
"9999                  99999          99999                99999          99999                  9999\n"+
"9999                   9999          9999       9999       9999          9999                   9999\n"+
"9999                    999          999        9999        999          999                    9999\n"+
"9999                    9999                   999999                   9999                    9999\n"+
"9999                    99999                 99999999                 99999                    9999\n"+
"9999                      999       9999     9999999999     9999       999                      9999\n"+
"9999        99999         999      99999    99999  99999    99999      999         99999        9999\n"+
"9999        99999                  99999    9999    9999    99999                  99999        9999\n"+
"9999        99999                  99999    999      999    99999                  99999        9999\n"+
"9999         999               999 9999                      9999 999               999         9999\n"+
"9999        99999              999                                999              99999        9999\n"+
"9999      99999999 999        999999                            999999        999 99999999      9999\n"+
"9999      999999999999        999999                            999999        999999999999      9999\n"+
"9999      999999999999       9999999                            9999999       999999999999      9999\n"+
"9999       99999999999      999999                                999999      99999999999       9999\n"+
"9999      99999999 999     99999                                    99999     999 99999999      9999\n"+
"99999    99999999         99999                                      99999         99999999    99999\n"+
"999999    999 999        99999         999                999         99999        999 999    999999\n"+
"9999999    9            99999          9999              9999          99999            9    9999999\n"+
"99999999               99999           99999999      99999999           99999               99999999\n"+
"999999999             99999              9999999    9999999              99999             999999999\n"+
"9999999999           99999               99999999  99999999               99999           9999999999\n"+
"99999999999         99999                   99999  99999                   99999         99999999999\n"+
"999999999999       99999                     9999999999                     99999       999999999999\n"+
"9999999999999     99999       99999             9999             99999       99999     9999999999999\n"+
"99999999999999   99999        99999             9999             99999        99999   99999999999999\n"+
"999999999999999999999         99999             9999             99999         999999999999999999999\n"+
"99999999999999999999           999                                999           99999999999999999999\n"+
"9999999999999999999           99999                              99999           9999999999999999999\n"+
"9999999999999999999         99999999 999                    999 99999999         9999999999999999999\n"+
"9999999999999999999         999999999999      999  999      999999999999         9999999999999999999\n"+
"99999999999999999999        999999999999      99999999      999999999999        99999999999999999999\n"+
"999999999999999999999        99999999999      99999999      99999999999        999999999999999999999\n"+
"9999999999999999999999      99999999 999        9999        999 99999999      9999999999999999999999\n"+
"99999999999999999999999    99999999             9999             99999999    99999999999999999999999\n"+
"999999999999999999999999    999 999                              999 999    999999999999999999999999\n"+
"9999999999999999999999999    9                                        9    9999999999999999999999999\n"+
"99999999999999999999999999                                                99999999999999999999999999\n"+
"999999999999999999999999999                     9999                     999999999999999999999999999\n"+
"9999999999999999999999999999                   999999                   9999999999999999999999999999\n"+
"99999999999999999999999999999                 99999999                 99999999999999999999999999999\n"+
"9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999\n"+
"9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999\n"+
"9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999\n"+
"9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999\n"+
"9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",  
"9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999\n"+
"9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999\n"+
"9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999\n"+
"99999999999     9999999               999999999999999999999999               9999999     99999999999\n"+
"9999999999      9999999                9999999999999999999999                9999999      9999999999\n"+
"999999999        99999                 9999999999999999999999                 99999        999999999\n"+
"99999999          999                   99999999999999999999                   999          99999999\n"+
"9999999           999                    999999999999999999                    999           9999999\n"+
"999999            999                     9999999999999999                     999            999999\n"+
"99999             999                     9999999999999999                     999             99999\n"+
"9999              9999                     99999999999999                     9999              9999\n"+
"999               99999                    99999999999999                    99999               999\n"+
"999                99999                    999999999999                    99999                999\n"+
"999                 99999                   999999999999                   99999                 999\n"+
"999                  99999                   9999999999                   99999                  999\n"+
"999                   99999                   99999999                   99999                   999\n"+
"99999                  9999                   99999999                   9999                  99999\n"+
"999999                  999                    999999                    999                  999999\n"+
"999999999999                                   999999                                   999999999999\n"+
"9999999999999                                   9999                                   9999999999999\n"+
"99999999999999                                   99                                   99999999999999\n"+
"999999    99999                                                                      99999    999999\n"+
"99999      99999      999   999                                      999   999      99999      99999\n"+
"999         99999     9999 9999                                      9999 9999     99999         999\n"+
"999          99999    999999999                                      999999999    99999          999\n"+
"999           9999     9999999                                        9999999     9999           999\n"+
"999            999      99999          999                999          99999      999            999\n"+
"999                    9999999        9999                9999        9999999                    999\n"+
"999                   999999999      99999                99999      999999999                   999\n"+
"999                   9999 9999     99999                  99999     9999 9999                   999\n"+
"999                   999   999    99999                    99999    999   999                   999\n"+
"999                               99999                      99999                               999\n"+
"999                              99999                        99999                              999\n"+
"999                             99999                          99999                             999\n"+
"999                             99999                          99999                             999\n"+
"999                              99999                        99999                              999\n"+
"9999                              99999                      99999                              9999\n"+
"99999                              99999                    99999                              99999\n"+
"999999                              99999                  99999                              999999\n"+
"999999999999999999999999999          99999                99999          999999999999999999999999999\n"+
"9999999999999999999999999999         999999              999999         9999999999999999999999999999\n"+
"99999999999999999999999999999       99999999            99999999       99999999999999999999999999999\n"+
"999999       999         99999     9999999                9999999     99999         999       999999\n"+
"99999        999          99999   99999  9                9  99999   99999          999        99999\n"+
"9999         999           99999999999                        99999999999           999         9999\n"+
"999          99999          999999999          9    9          999999999          99999          999\n"+
"999          9999999         9999999           99  99           9999999         9999999          999\n"+
"999            99999                         9999999999                         99999            999\n"+
"999              99                           99999999                           99              999\n"+
"999                                            999999                                            999\n"+
"999                                            999999                                            999\n"+
"999              99                           99999999                           99              999\n"+
"999            99999                         9999999999                         99999            999\n"+
"999          9999999         9999999           99  99           9999999         9999999          999\n"+
"999          99999          999999999          9    9          999999999          99999          999\n"+
"9999         999           99999999999                        99999999999           999         9999\n"+
"99999        999          99999   99999  9                9  99999   99999          999        99999\n"+
"999999       999         99999     9999999                9999999     99999         999       999999\n"+
"99999999999999999999999999999       99999999            99999999       99999999999999999999999999999\n"+
"9999999999999999999999999999         999999              999999         9999999999999999999999999999\n"+
"999999999999999999999999999          99999                99999          999999999999999999999999999\n"+
"999999                              99999                  99999                              999999\n"+
"99999                              99999                    99999                              99999\n"+
"9999                              99999                      99999                              9999\n"+
"999                              99999                        99999                              999\n"+
"999                             99999                          99999                             999\n"+
"999                             99999                          99999                             999\n"+
"999                              99999                        99999                              999\n"+
"999                               99999                      99999                               999\n"+
"999                   999   999    99999                    99999    999   999                   999\n"+
"999                   9999 9999     99999                  99999     9999 9999                   999\n"+
"999                   999999999      99999                99999      999999999                   999\n"+
"999                    9999999        9999                9999        9999999                    999\n"+
"999            999      99999          999                999          99999      999            999\n"+
"999           9999     9999999                                        9999999     9999           999\n"+
"999          99999    999999999                                      999999999    99999          999\n"+
"999         99999     9999 9999                                      9999 9999     99999         999\n"+
"99999      99999      999   999                                      999   999      99999      99999\n"+
"999999    99999                                                                      99999    999999\n"+
"99999999999999                                   99                                   99999999999999\n"+
"9999999999999                                   9999                                   9999999999999\n"+
"999999999999                                   999999                                   999999999999\n"+
"999999                  999                    999999                    999                  999999\n"+
"99999                  9999                   99999999                   9999                  99999\n"+
"999                   99999                   99999999                   99999                   999\n"+
"999                  99999                   9999999999                   99999                  999\n"+
"999                 99999                   999999999999                   99999                 999\n"+
"999                99999                    999999999999                    99999                999\n"+
"999               99999                    99999999999999                    99999               999\n"+
"9999              9999                     99999999999999                     9999              9999\n"+
"99999             999                     9999999999999999                     999             99999\n"+
"999999            999                     9999999999999999                     999            999999\n"+
"9999999           999                    999999999999999999                    999           9999999\n"+
"99999999          999                   99999999999999999999                   999          99999999\n"+
"999999999        99999                 9999999999999999999999                 99999        999999999\n"+
"9999999999      9999999                9999999999999999999999                9999999      9999999999\n"+
"99999999999     9999999               999999999999999999999999               9999999     99999999999\n"+
"9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999\n"+
"9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999\n"+
"9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
"9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999\n"+
"9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999\n"+
"9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999\n"+
"9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999\n"+
"9999999999                99999999    999                  999    99999999                9999999999\n"+
"9999999999                99999999    999                  999    99999999                9999999999\n"+
"99999999                   999999     9999                9999     999999                   99999999\n"+
"9999999    999              9999      99999              99999      9999              999    9999999\n"+
"999999     999              9999       9999              9999       9999              999     999999\n"+
"999999      99              9999        999              999        9999              99      999999\n"+
"9999        99              9999                                    9999              99        9999\n"+
"9999   99   99              9999                                    9999              99   99   9999\n"+
"9999   99999999             9999                                    9999             99999999   9999\n"+
"9999   99999999999          9999                                    9999          99999999999   9999\n"+
"9999        999999          9999                                    9999          999999        9999\n"+
"9999         99999          9999                                    9999          99999         9999\n"+
"9999         999999         9999           999        999           9999         999999         9999\n"+
"9999         9999999        9999           9999      9999           9999        9999999         9999\n"+
"9999            9999999     9999           99999    99999           9999     9999999            9999\n"+
"9999             999999     9999            9999    9999            9999     999999             9999\n"+
"9999              99999      99              999    999              99      99999              9999\n"+
"9999              999999     99               99999999               99     999999              9999\n"+
"9999              9999999              9999999999999999999999              9999999              9999\n"+
"9999                 9999999       999999999999999999999999999999       9999999                 9999\n"+
"9999                  999999    99999999999999999  99999999999999999    999999                  9999\n"+
"9999                   99999    9999999999                9999999999    99999                   9999\n"+
"99999                  99999    99999                          99999    99999                  99999\n"+
"999999                 99999                                            99999                 999999\n"+
"99999999999999999999                                                            99999999999999999999\n"+
"9999999999999999999999                           99                           9999999999999999999999\n"+
"9999999999999999999999                          9999                          9999999999999999999999\n"+
"99999999999999999999           999              9999              999           99999999999999999999\n"+
"999999                  999   99999             9999             99999   999                  999999\n"+
"99999                   999   99999             9999             99999   999                   99999\n"+
"9999                    999   99999             9999             99999   999                    9999\n"+
"9999                   9999    999              9999              999    9999                   9999\n"+
"9999                   9999                     9999                     9999                   9999\n"+
"9999                   999               999    9999    999               999                   9999\n"+
"9999                   999               9999   9999   9999               999                   9999\n"+
"9999                  9999               99999  9999  99999               9999                  9999\n"+
"9999                  9999                99999 9999 99999                9999                  9999\n"+
"9999999               9999           999   99999999999999   999           9999               9999999\n"+
"999999999             999            9999   999999999999   9999            999             999999999\n"+
"9999999999      999   999            99999    99999999    99999            999   999      9999999999\n"+
"9999  9999      9999  999             99999   99999999   99999             999  9999      9999  9999\n"+
"9999   999      99999 999              9999              9999              999 99999      999   9999\n"+
"9999             99999999               99999          99999               99999999             9999\n"+
"9999              9999999                9999          9999                9999999              9999\n"+
"9999                 9999     999999999999999          999999999999999     9999                 9999\n"+
"9999                 999     9999999999999999          9999999999999999     999                 9999\n"+
"9999                 999     9999999999999999          9999999999999999     999                 9999\n"+
"9999                 9999     999999999999999          999999999999999     9999                 9999\n"+
"9999              9999999                9999          9999                9999999              9999\n"+
"9999             99999999               99999          99999               99999999             9999\n"+
"9999   999      99999 999              9999              9999              999 99999      999   9999\n"+
"9999  9999      9999  999             99999   99999999   99999             999  9999      9999  9999\n"+
"9999999999      999   999            99999    99999999    99999            999   999      9999999999\n"+
"999999999             999            9999   999999999999   9999            999             999999999\n"+
"9999999               9999           999   99999999999999   999           9999               9999999\n"+
"9999                  9999                99999 9999 99999                9999                  9999\n"+
"9999                  9999               99999  9999  99999               9999                  9999\n"+
"9999                   999               9999   9999   9999               999                   9999\n"+
"9999                   999               999    9999    999               999                   9999\n"+
"9999                   9999                     9999                     9999                   9999\n"+
"9999                   9999    999              9999              999    9999                   9999\n"+
"9999                    999   99999             9999             99999   999                    9999\n"+
"99999                   999   99999             9999             99999   999                   99999\n"+
"999999                  999   99999             9999             99999   999                  999999\n"+
"99999999999999999999           999              9999              999           99999999999999999999\n"+
"9999999999999999999999                          9999                          9999999999999999999999\n"+
"9999999999999999999999                           99                           9999999999999999999999\n"+
"99999999999999999999                                                            99999999999999999999\n"+
"999999                 99999                                            99999                 999999\n"+
"99999                  99999    99999                          99999    99999                  99999\n"+
"9999                   99999    9999999999                9999999999    99999                   9999\n"+
"9999                  999999    99999999999999999  99999999999999999    999999                  9999\n"+
"9999                 9999999       999999999999999999999999999999       9999999                 9999\n"+
"9999              9999999              9999999999999999999999              9999999              9999\n"+
"9999              999999     99               99999999               99     999999              9999\n"+
"9999              99999      99              999    999              99      99999              9999\n"+
"9999             999999     9999            9999    9999            9999     999999             9999\n"+
"9999            9999999     9999           99999    99999           9999     9999999            9999\n"+
"9999         9999999        9999           9999      9999           9999        9999999         9999\n"+
"9999         999999         9999           999        999           9999         999999         9999\n"+
"9999         99999          9999                                    9999          99999         9999\n"+
"9999        999999          9999                                    9999          999999        9999\n"+
"9999   99999999999          9999                                    9999          99999999999   9999\n"+
"9999   99999999             9999                                    9999             99999999   9999\n"+
"9999   99   99              9999                                    9999              99   99   9999\n"+
"9999        99              9999                                    9999              99        9999\n"+
"999999      99              9999        999              999        9999              99      999999\n"+
"999999     999              9999       9999              9999       9999              999     999999\n"+
"9999999    999              9999      99999              99999      9999              999    9999999\n"+
"99999999                   999999     9999                9999     999999                   99999999\n"+
"9999999999                99999999    999                  999    99999999                9999999999\n"+
"9999999999                99999999    999                  999    99999999                9999999999\n"+
"9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999\n"+
"9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999\n"+
"9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999\n"+
"9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999"
];
var mapsNames = ['Azergayere','Spikes',"Crystals"];
var mapSpawns = [
  [0,400,400,0,0,-400,-400,0],[8,9,10,11,12,13,14,15],[395,395,395,-395,-395,395,-395,-395]
];
var generatorSpawns = [[0,0,0,0],[]];
var map = {};
var map_ = maps[~~(Math.random()*maps.length)];
var colors_teams = [
  "#DD23BB","#34E6DE","#45D11F","#E59529","#BED914","#EA3D13"
];
var hues_teams = [
  300,180,120,30,60,0
];
var name_teams = [" Pink "," Cyan ","Green ","Orange","Yellow"," Red "];
var allTeams = [];
var hues = [];
var colors = [];
for (let i = 0; i<4;i++) {
  var color = colors_teams[~~(Math.random()*colors_teams.length)];
  var index = colors_teams.indexOf(color);
  var hue = hues_teams[index];
  var name_ = name_teams[index];
  allTeams.push(color);
  allTeams.push(hue);
  allTeams.push(name_);
  hues.push(hue);
  colors.push(color);
  colors_teams.splice(index,1);
  hues_teams.splice(hues_teams.indexOf(hue),1);
  name_teams.splice(name_teams.indexOf(name_),1);
}

var teams = {
  0: {
    color: allTeams[0], hue: allTeams[1], name: allTeams[2]
  },
  1: {
    color: allTeams[3], hue: allTeams[4], name: allTeams[5]
  },
  2: {
    color: allTeams[6], hue: allTeams[7], name: allTeams[8]
  },
  3: {
    color: allTeams[9], hue: allTeams[10], name: allTeams[11]
  }
};

Object.assign(map,{
  map:  map_,
  name: mapsNames[maps.indexOf(map_)],
  generators: generatorSpawns[maps.indexOf(map_)]
});
var getRandomInt = function(max) {
  return Math.floor(Math.random() * max);
};

var preventShortcut = function(ship) {
  var shortcuts = ["1","2","3","4","5","6","7","8"];
  for (let i = 0; i < 8;i++) {
    var component = {
      id: `prevent_shortcut_${shortcuts[i]}`,
      position: [0,5*i,0,0],
      shortcut: shortcuts[i],
      visible: true,
      clickable:true,
      components: [
        { type: "box",position:[0,0,100,100],fill:"#CDE",stroke:"#6D6D6D",width:1},
        ]
    };
    ship.setUIComponent(component);
  }
};

var setForce = function(ship) {
    ship.custom.setForce = false;
    var force = {
      id: "force",
      position: [20,92,30,8],
      shortcut: "2",
      visible: true,
      clickable:true,
      components: [
        { type: "box",position:[0,0,100,100],fill:"#9A622D",stroke:"#351B02",width:20},
        { type: "text",position:[0,45,50,35],color:"#E8B37D",value:"Strength  "},
        ]
    };
    ship.setUIComponent(force);
};

var stade = 10;
var createGems = function(game) {
  if (game.step % 60*10 === 0) {
    game.addCrystal({x:0,y:0,value:stade});
  }
};
var setTypes = function(ship) {
    var types = [
      ["Protection","Strength  "],
      ["1","2"],
      [["#51A2A2","#033737","#275F5F"],["#500E0E","#360303","#E77D7D"]]
    ];
  for (let i = 0; i < 2;i++) {
    var component = {
      id: types[0][i],
      position: [i*60,92,20,8],
      shortcut: types[1][i],
      visible: true,
      clickable:true,
      components: [
        { type: "box",position:[0,0,100,100],fill:types[2][i][0],stroke:types[2][i][1],width:20},
        { type: "text",position:[5 * (i + 1),40 + i*5,50,35 + i * 25],color:types[2][i][2],value:types[0][i]},
        ]
    };
    ship.setUIComponent(component);
  }
};
var secondaries = ["Torpedo","Missile","Defense","Attack ","Trap   ","Spell  ","Defense 8","Defense 4"];
var prices = ["550","270","130","130","50","100","25","50"];
var setShop = function(ship) {
  for (let i = 0; i < 4;i++) {
    var component = {
      id: secondaries[i],
      position: [15 + i*15,40,14,8],
      shortcut: `${i + 4}`,
      visible: true,
      clickable:true,
      components: [
        { type: "box",position:[0,0,100,100],fill:"#9D9D9D",stroke:"#787878",width:15},
        { type: "text",position:[2,25,50,35],color:"#CDE",align:"center",value:`${secondaries[i]}`},
        { type: "box",position:[61,34,35.5,50],stroke:"#CDE",width:5},
        { type: "text",position:[54.5,45,50,35],color:"#CDE",align:"center",value:prices[i] + " 💎"},
        ]
    };
    ship.setUIComponent(component);
  }
  for (let i_ = 4; i_ < 6;i_++) {
    var component2 = {
      id: secondaries[i_],
      position: [15 + (i_ - 4)*15,50,14,8],
      shortcut: `${i_ + 4}`,
      visible: true,
      clickable:true,
      components: [
        { type: "box",position:[0,0,100,100],fill:"#9D9D9D",stroke:"#787878",width:15},
        { type: "text",position:[2,25,50,35],color:"#CDE",align:"center",value:`${secondaries[i_]}`},
        { type: "box",position:[61,34,35.5,50],stroke:"#CDE",width:5},
        { type: "text",position:[54.5,45,50,35],color:"#CDE",align:"center",value:prices[i_] + " 💎"},
        ]
    };
    ship.setUIComponent(component2);
  }
};
var setColors = function(ship) {
  for (let i = 0;i<4;i++) {
    var component = {
      id: colors[i],
      position: [30 + i*5 + i*4,75,8,14],
      visible: true,
      clickable:true,
      components: [
        { type: "box",position:[0,0,100,100],fill:teams[i].color,stroke:"#6D6D6D",width:15},
        ]
    };
    ship.setUIComponent(component);
  }
};
var show
var showText = function(ship,text,pos,pos1,color) {
  var myText = {
    id: "myText",
    position: pos,
    visible: true,
    components: [
      { type: "text",value:text,position:pos1,color:color}
      ]
  };
  ship.setUIComponent(myText);
};

this.tick = function(game) {
  //setSpawns(game);
  //createGems(game);
  if (game.step % 15 === 0) {
    for (let ship of game.ships) {
      if (ship.shield < 0 && ship.crystals > 0) {
        ship.set({kill:true});
      }
      //setSpeed(ship);
      setShop(ship);
      setColors(ship);
      setScorebaord();
      pushScoreboardPerHue();
      ship.setUIComponent(scoreboard);
      if (ship.custom.init !== true) {
        ship.custom.init = true;
        preventShortcut(ship);
        ship.custom.protectionLevel = 0;
        setColors(ship);
        setTypes(ship);
        ship.set({x:0,y:0,idle:false,team:1});
        showText(ship,'Choose a color',[22.5,60,50,14],[15,50,70,40],"#CDE");
      }
    }
    if (game.custom.stade === 0) {
      if (game.ships.length === 8) {
        game.custom.stade = 1;
        pushHues();
      }
    }
  }
};
var shipsPerHues = [[],[],[],[]];
var pushHues = function() {
  shipsPerHues = [[],[],[],[]];
  for (let i =0;i<game.ships.length;i++) {
    for (let hue_ in hues) {
      if (game.ships[i].hue === hue_) {
        index = hues.indexOf(hue_);
        shipsPerHues.push(game.ships[i].id);
        return;
      }
    }
  }
  for (let i = 0; i < shipsPerHues.length ; i++) {
    if (shipsPerHues[i].length != 2) {
      game.ships[i].set({hue:hues[i]});
    }
  }
};
var scoreboard = {
  id: "scoreboard",
  components: []
};
var setScorebaord = function() {
  if (scoreboard.components.length != game.ships.length + 8) {
    scoreboard.components = []; 
  }
    for (let i = 0;i<4;i++) {
      scoreboard.components.push(
        { type: "box",position:[0,0 + i * 25,100,5],stroke:teams[i].color,fill:teams[i].color,width:15},
        { type: "text",position:[40,-7.5 + i * 25,20,20],value: teams[i].name,color:"#6B6C6B"},
      );
    }
};

var pushScoreboardPerHue = function() {
  for (let i = 8;i < scoreboard.components.length;i++) {
    scoreboard.components.splice(i,1)
  }
  for (let i = 0; i < shipsPerHues.length ; i++) {
    if (shipsPerHues[i][0] !== null) {
      scoreboard.components.push(
        { type: "player",position:[2.5,7 + 25 * i,80,7],id:shipsPerHues[i][0],color:"#CDE",align:"left"}
      );
    }
    if (shipsPerHues[i][0] !== null) {
      scoreboard.components.push(
        { type: "player",position:[2.5,32 + 25 * i,80,7],id:shipsPerHues[i][1],color:"#CDE",align:"left"}
      );
    }
  }
};


var setSpawns = function(game) {
  if (game.step === 0) {
    game.custom.stade = 0;
    for (let i = 0; i<8;i+=2) {
      var object = {};
      var assignation = {
        id: `alien_${i}`,
        obj: "https://raw.githubusercontent.com/W0lfan/Starblast-Defend-The-Alien/main/Aliens/Aliens%20OBJ/model_20.obj",
        diffuse: "https://raw.githubusercontent.com/W0lfan/Starblast-Defend-The-Alien/blob/main/Aliens/lambert/lambert_20.jpg",
        bump: "https://raw.githubusercontent.com/W0lfan/Starblast-Defend-The-Alien/blob/main/Aliens/lambert/lambert_20.jpg",
        emissiveColor: 0x80FFFF,
        specularColor: 0x805010,
        diffuseColor:0xFF8080,
        transparent: false,
      };
      game.setObject({
        id: `alien_${i}`,
        type: assignation,
        position: {
          x:mapSpawns[maps.indexOf(map_)][i],
          y:mapSpawns[maps.indexOf(map_)][i + 1],
          z:-10
        },
        rotation: {
          x:0,
          y:0,
          z:0,
        },
        scale: {x:0.2,y:0.2,z:0.2}
      });
    }
  }
};
/*

      var assignation = {
        id: "alien",
        obj: "https://raw.githubusercontent.com/W0lfan/Starblast-Defend-The-Alien/main/Aliens/Aliens%20OBJ/model_20",
        diffuse: "https://raw.githubusercontent.com/mrGoldman1122/starblastGa/master/ship_lambert_texture.png",
        bump: "https://raw.githubusercontent.com/mrGoldman1122/starblastGa/master/ship_lambert_texture.png",
        emissiveColor: 0x80FFFF,
        specularColor: 0x805010,
        diffuseColor:0xFF8080,
        transparent: false,
      };
      game.setObject({
        id: "alien",
        type: assignation,
        position: {
          x:0,
          y:0,
          z:-10
        },
        rotation: {
          x:0,
          y:0,
          z:0,
        },
        scale: {x:20,y:20,z:20}
      });
*/

this.options = {
  root_mode: " ",
  map_size: 100,
  friendly_colors:2,
  custom_map:map.map,
  radar_zoom:1,
  weapons_store:false
};

this.event = function(event,game) {
  var ship = event.ship;
  var component = event.id;
  switch (event.name) {
    case "ui_component_clicked":
      for (let color in colors) {
        if (component === color) {
          var index = colors.indexOf(color);
          var hue = hues[index];
          echo(hue);
          ship.set({hue:hue});
        }
      }
      break ;
  }
};
// Add crystals to the game, credits to BHPSNGUM
;(function() {
  var manageAliens = function (game) {
    try {
      if (game.custom.addCrystal_init) return;
      var modding = game.modding, internal_key = Object.keys(modding).find(key => {
        try {
          return typeof modding[key].alienCreated == "function" && key != "game";
        }
        catch(e) {
          return false;
        }
      }), internals = modding[internal_key];
      if (!internals.alienCreated.old) {
        let alienCreated =  function () {
          let args = arguments, tx = alienCreated.old.apply(this, args), t = args[0].request_id, alien = this.modding.game.findAlien(args[0].id);
          if (this.modding.game.aliens.find(alien => alien.request_id === t) && alien) {
            let tid = this.modding.game.custom.execAliens.indexOf(t);
            if (tid != -1) alien.set({kill: true});
          }
          return tx;
        };
        alienCreated.old = internals.alienCreated;
        internals.alienCreated = alienCreated;
      }
      if (!internals.eventReceived.old) {
        let eventReceived =  function () {
          let args = arguments, skipped;
          try {
            if (args[0].data.name == "alien_destroyed") skipped = this.modding.game.custom.execAliens.indexOf(this.modding.game.findAlien(args[0].data.alien).request_id) != -1;
          }
          catch (e) {
            skipped = false;
          }
          let context = this.modding.context, event = context.event;
          if (skipped) context.event = null;
          let x =  eventReceived.old.apply(this, args);
          context.event = event;
          return x;
        };
        eventReceived.old = internals.eventReceived;
        internals.eventReceived = eventReceived;
      }
      game.custom.execAliens = [];
      game.addCrystal = function(data)
      {
        data = data || {};
        let crystal = {x:data.x||0, y:data.y||0, value: data.value||0,
          toString: function(){return "Crystal:"+JSON.stringify(this)}
        };
        this.custom.execAliens.push(this.addAlien({code:13,x:crystal.x,y:crystal.y,crystal_drop:crystal.value}).request_id);
        return crystal;
      };
      game.custom.addCrystal_init = true;
    }
    catch (e) {
      console.error(e);
      game.modding.terminal.error(new Error("Failed to initialize 'game.addCrystal': Modding instances not found"));
    }
  }, tick = this.tick;
  this.tick = function () {
    this.tick = tick;
    try { manageAliens.apply(this, arguments) } catch (e) {}
    return typeof this.tick == "function" && this.tick.apply(this, arguments);
  };
}).call(this);